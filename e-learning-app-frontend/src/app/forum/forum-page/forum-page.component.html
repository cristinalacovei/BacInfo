<div class="container">
  <!-- 🔼 Secțiunea de întrebare nouă -->
  <div class="ask-form">
    <h2 class="gradient-header">Pune o întrebare</h2>

    <form
      *ngIf="questionForm"
      [formGroup]="questionForm"
      (ngSubmit)="submitQuestion()"
    >
      <quill-editor
        formControlName="questionText"
        [modules]="editorConfig"
        placeholder="Scrie întrebarea ta..."
      ></quill-editor>
      <button type="submit" [disabled]="questionForm.invalid">
        Postează întrebarea
      </button>
    </form>
  </div>

  <div class="sort-toggle">
    <button (click)="toggleSortOrder()">
      Sortează după dată: {{ sortAsc ? "Crescător ↑" : "Descrescător ↓" }}
    </button>
  </div>
  <!-- 📋 Lista întrebărilor -->
  <div
    *ngFor="let question of allQuestions"
    class="question-card"
    (click)="goToQuestion(question.id)"
  >
    <div class="card-subtitle">
      <mat-icon
        fontIcon="person"
        style="font-size: 16px; vertical-align: middle"
      ></mat-icon>
      <span class="author-name">
        {{ question.author.firstName }} {{ question.author.lastName }}
        <span class="user-role"
          >({{ question.author.userRole | titlecase }})</span
        >
      </span>
      &nbsp;•&nbsp;
      <mat-icon
        fontIcon="schedule"
        style="font-size: 16px; vertical-align: middle"
      ></mat-icon>
      {{ question.createdAt | date : "short" }}
    </div>

    <!-- Buton vizibil DOAR pentru admini -->
    <button
      *ngIf="isAdmin"
      class="delete-button"
      (click)="confirmDelete(question.id, $event)"
      title="Șterge întrebarea"
    >
      🗑️
    </button>

    <div class="question-text-container">
      <div
        class="question-text"
        [class.preview]="shouldTruncate(question)"
        [innerHTML]="question.questionText"
      ></div>
    </div>

    <div class="response-count">
      {{ question.answers?.length || 0 }}
      {{ question.answers?.length === 1 ? "răspuns" : "răspunsuri" }}
    </div>
  </div>
  <div class="pagination-controls">
    <button (click)="prevPage()" [disabled]="currentPage === 1">
      ⬅ Anterior
    </button>
    <span>Pagina {{ currentPage }} din {{ totalPages }}</span>
    <button (click)="nextPage()" [disabled]="currentPage === totalPages">
      Următor ➡
    </button>
  </div>
</div>
